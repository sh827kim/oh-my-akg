{
  "version": "v0",
  "repos": [
    { "id": "acme/orders-service", "name": "orders-service" },
    { "id": "acme/billing-service", "name": "billing-service" },
    { "id": "acme/inventory-service", "name": "inventory-service" },
    { "id": "acme/notification-worker", "name": "notification-worker" }
  ],
  "cases": [
    {
      "name": "java_orders_to_billing",
      "fromId": "acme/orders-service",
      "file": {
        "path": "src/main/java/com/acme/orders/BillingGateway.java",
        "content": "import com.acme.billing.client.BillingClient;\npublic class BillingGateway {\n  void send() { WebClient.create(\"https://billing.internal/v1/payments\").retrieve(); }\n  void publish() { kafkaTemplate.send(\"billing-events\", payload); }\n}\n"
      },
      "expected": [
        { "toId": "acme/billing-service", "type": "depend_on" },
        { "toId": "acme/billing-service", "type": "call" },
        { "toId": "acme/billing-service", "type": "produce" }
      ]
    },
    {
      "name": "ts_inventory_calls_orders",
      "fromId": "acme/inventory-service",
      "file": {
        "path": "src/inventory/client.ts",
        "content": "import { OrdersClient } from \"@acme/orders-service/client\";\nexport async function sync() {\n  await fetch(\"https://orders.internal/api/v1/items\");\n}\n"
      },
      "expected": [
        { "toId": "acme/orders-service", "type": "depend_on" },
        { "toId": "acme/orders-service", "type": "call" }
      ]
    },
    {
      "name": "ts_orders_produces_notification",
      "fromId": "acme/orders-service",
      "file": {
        "path": "src/orders/events.ts",
        "content": "export async function publishEvent() {\n  await producer.send({ topic: \"notification-events\", messages: [] });\n}\n"
      },
      "expected": [
        { "toId": "acme/notification-worker", "type": "produce" }
      ]
    },
    {
      "name": "python_notification_consumes_orders",
      "fromId": "acme/notification-worker",
      "file": {
        "path": "app/worker/consumer.py",
        "content": "def consume_events():\n    consumer.subscribe([\"orders-events\"])\n"
      },
      "expected": [
        { "toId": "acme/orders-service", "type": "consume" }
      ]
    },
    {
      "name": "python_notification_depends_on_billing",
      "fromId": "acme/notification-worker",
      "file": {
        "path": "app/worker/billing_task.py",
        "content": "from acme.billing.client import billing_client\n"
      },
      "expected": [
        { "toId": "acme/billing-service", "type": "depend_on" }
      ]
    }
  ]
}
