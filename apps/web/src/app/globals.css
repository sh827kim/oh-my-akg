/**
 * 전역 CSS — Tailwind CSS v4
 * Cosmic 테마: Violet Primary + Cyan Secondary
 * 다크/라이트 모드 지원 (glass-morphism 유틸리티 포함)
 */
@import "tailwindcss";

/*
 * 모노레포 패키지 소스 스캔 — packages/ui 안의 클래스명을 자동 감지
 * 이 디렉티브 없으면 Dialog, Button 등 UI 패키지의 유틸리티 클래스가 CSS에 미생성됨
 */
@source "../../../../packages/ui/src";

/*
 * TailwindCSS v4 — CSS 변수 → 유틸리티 클래스 매핑
 * @theme inline 없이는 bg-popover, bg-primary 등이 transparent으로 렌더됨
 */
@theme inline {
  --color-background:             hsl(var(--background));
  --color-foreground:             hsl(var(--foreground));
  --color-card:                   hsl(var(--card));
  --color-card-foreground:        hsl(var(--card-foreground));
  --color-popover:                hsl(var(--popover));
  --color-popover-foreground:     hsl(var(--popover-foreground));
  --color-primary:                hsl(var(--primary));
  --color-primary-foreground:     hsl(var(--primary-foreground));
  --color-secondary:              hsl(var(--secondary));
  --color-secondary-foreground:   hsl(var(--secondary-foreground));
  --color-muted:                  hsl(var(--muted));
  --color-muted-foreground:       hsl(var(--muted-foreground));
  --color-accent:                 hsl(var(--accent));
  --color-accent-foreground:      hsl(var(--accent-foreground));
  --color-destructive:            hsl(var(--destructive));
  --color-destructive-foreground: hsl(var(--destructive-foreground));
  --color-border:                 hsl(var(--border));
  --color-input:                  hsl(var(--input));
  --color-ring:                   hsl(var(--ring));
}

/* ─── 디자인 토큰 ─── */
@layer base {
  /* Light mode */
  :root {
    --background: 0 0% 98%;
    --foreground: 240 10% 10%;
    --card: 0 0% 100%;
    --card-foreground: 240 10% 10%;
    --popover: 0 0% 100%;
    --popover-foreground: 240 10% 10%;
    --primary: 263 70% 50%;
    --primary-foreground: 0 0% 100%;
    --secondary: 187 94% 43%;
    --secondary-foreground: 0 0% 100%;
    --muted: 240 5% 93%;
    --muted-foreground: 240 4% 46%;
    --accent: 263 30% 93%;
    --accent-foreground: 263 70% 50%;
    --destructive: 0 84% 60%;
    --destructive-foreground: 0 0% 100%;
    --border: 240 6% 88%;
    --input: 240 6% 88%;
    --ring: 263 70% 50%;
    --radius: 0.5rem;
    /* 사이드바 */
    --sidebar-width: 256px;
    --sidebar-bg: 0 0% 97%;
    --sidebar-fg: 240 10% 20%;
    /* 성공/경고 */
    --success: 142 76% 36%;
    --success-foreground: 0 0% 100%;
    --warning: 38 92% 50%;
    --warning-foreground: 0 0% 100%;
  }

  /* Dark mode — Cosmic Theme */
  .dark {
    --background: 240 20% 2%;
    --foreground: 0 0% 98%;
    --card: 240 17% 5%;
    --card-foreground: 0 0% 98%;
    --popover: 240 17% 5%;
    --popover-foreground: 0 0% 98%;
    --primary: 263 70% 58%;
    --primary-foreground: 0 0% 100%;
    --secondary: 187 94% 43%;
    --secondary-foreground: 0 0% 100%;
    --muted: 240 12% 12%;
    --muted-foreground: 240 5% 64%;
    --accent: 240 12% 12%;
    --accent-foreground: 0 0% 98%;
    --destructive: 0 62% 30%;
    --destructive-foreground: 0 0% 98%;
    --border: 240 8% 16%;
    --input: 240 8% 16%;
    --ring: 263 70% 50%;
    /* 사이드바 */
    --sidebar-bg: 240 20% 3%;
    --sidebar-fg: 240 5% 85%;
    /* 성공/경고 */
    --success: 142 76% 36%;
    --success-foreground: 0 0% 100%;
    --warning: 38 92% 50%;
    --warning-foreground: 0 0% 100%;
  }

  * {
    border-color: hsl(var(--border));
  }

  body {
    background-color: hsl(var(--background));
    color: hsl(var(--foreground));
  }

  /* 다크 모드 cosmic gradient 배경 */
  .dark body {
    background-image:
      radial-gradient(circle at 50% 0%, rgba(139, 92, 246, 0.12) 0%, transparent 60%),
      radial-gradient(circle at 100% 0%, rgba(6, 182, 212, 0.08) 0%, transparent 50%);
    background-attachment: fixed;
  }
}

/* ─── Glass-morphism 유틸리티 ─── */
@layer utilities {
  /* 글래스 패널 — 다크 모드 */
  .glass-panel {
    background: rgba(0, 0, 0, 0.4);
    backdrop-filter: blur(24px);
    -webkit-backdrop-filter: blur(24px);
    border: 1px solid rgba(255, 255, 255, 0.1);
    box-shadow: 0 4px 30px rgba(0, 0, 0, 0.1);
  }

  /* 글래스 패널 — 라이트 모드 */
  :root:not(.dark) .glass-panel {
    background: rgba(255, 255, 255, 0.8);
    border-color: rgba(0, 0, 0, 0.08);
    box-shadow: 0 4px 30px rgba(0, 0, 0, 0.05);
  }

  /* 글래스 카드 — 다크 모드 */
  .glass-card {
    background: rgba(255, 255, 255, 0.05);
    backdrop-filter: blur(16px);
    -webkit-backdrop-filter: blur(16px);
    border: 1px solid rgba(255, 255, 255, 0.05);
    transition: all 0.3s ease;
  }

  .glass-card:hover {
    border-color: rgba(255, 255, 255, 0.1);
  }

  /* 글래스 카드 — 라이트 모드 */
  :root:not(.dark) .glass-card {
    background: rgba(255, 255, 255, 0.7);
    border-color: rgba(0, 0, 0, 0.05);
  }

  :root:not(.dark) .glass-card:hover {
    border-color: rgba(0, 0, 0, 0.1);
  }

  /* 텍스트 글로우 (다크 모드 전용) */
  .dark .text-glow {
    text-shadow: 0 0 20px rgba(255, 255, 255, 0.3);
  }

  /* Primary 글로우 */
  .glow-primary {
    box-shadow: 0 0 20px rgba(139, 92, 246, 0.3);
  }

  /* Secondary 글로우 */
  .glow-secondary {
    box-shadow: 0 0 20px rgba(6, 182, 212, 0.3);
  }
}

/* ─── 커스텀 스크롤바 ─── */
::-webkit-scrollbar {
  width: 6px;
  height: 6px;
}

::-webkit-scrollbar-track {
  background: transparent;
}

.dark ::-webkit-scrollbar-thumb {
  background: rgba(255, 255, 255, 0.1);
  border-radius: 9999px;
}

.dark ::-webkit-scrollbar-thumb:hover {
  background: rgba(255, 255, 255, 0.2);
}

:root:not(.dark) ::-webkit-scrollbar-thumb {
  background: rgba(0, 0, 0, 0.15);
  border-radius: 9999px;
}

:root:not(.dark) ::-webkit-scrollbar-thumb:hover {
  background: rgba(0, 0, 0, 0.25);
}

/* ─── React Flow 커스텀 스타일 ─── */
.react-flow__node {
  border-radius: 8px;
}

.dark .react-flow__minimap {
  background-color: rgba(0, 0, 0, 0.4);
}

.dark .react-flow__controls button {
  background-color: rgba(0, 0, 0, 0.6);
  border-color: rgba(255, 255, 255, 0.1);
  color: rgba(255, 255, 255, 0.8);
}

/* ─── Cytoscape 컨테이너 ─── */
.cytoscape-container {
  width: 100%;
  height: 100%;
}

/* ─── 커스텀 애니메이션 ─── */
@keyframes float {
  0%, 100% { transform: translateY(0); }
  50% { transform: translateY(-4px); }
}

.animate-float {
  animation: float 3s ease-in-out infinite;
}

@keyframes glow-pulse {
  0%, 100% { opacity: 0.6; }
  50% { opacity: 1; }
}

.animate-glow-pulse {
  animation: glow-pulse 2s ease-in-out infinite;
}
